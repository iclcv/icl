
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>XML-based Configuration Files &#8212; ICL Manual</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Interactive GUI Applications" href="interactive-gui-apps.html" />
    <link rel="prev" title="Evaluating Program Arguments" href="program-arguments.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="interactive-gui-apps.html" title="Interactive GUI Applications"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="program-arguments.html" title="Evaluating Program Arguments"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">ICL Manual</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../extras/tutorial.html" accesskey="U">Tutorials</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <script src="../js/jquery.tools.min.js"></script>

<div id="sticky">
  <table class="sticky-table">
  <tr><td><div class="sticky-entry "id="sticky-1"/><a class="sticky-link" href="../modules/utils.html">utils</a></td></tr>
  <tr><td><div class="sticky-entry "id="sticky-2"/><a class="sticky-link" href="../modules/math.html">math</a></td></tr>
  <tr><td><div class="sticky-entry "id="sticky-3"/><a class="sticky-link" href="../modules/core.html">core</a></td></tr>
  <tr><td><div class="sticky-entry "id="sticky-4"/><a class="sticky-link" href="../modules/filter.html">filter</a></td></tr>
  <tr><td><div class="sticky-entry "id="sticky-5"/><a class="sticky-link"href="../modules/io.html">io</a></td></tr>
  <tr><td><div class="sticky-entry "id="sticky-6"/><a class="sticky-link"href="../modules/qt.html">qt</a></td></tr>
  <tr><td><div class="sticky-entry "id="sticky-7"/><a class="sticky-link"href="../modules/cv.html">cv</a></td></tr>
  <tr><td><div class="sticky-entry "id="sticky-8"/><a class="sticky-link"href="../modules/geom.html">geom</a></td></tr>
  <tr><td><div class="sticky-entry "id="sticky-9"/><a class="sticky-link"href="../modules/markers.html">marker</a></td></tr>
  <tr><td><div class="sticky-entry "id="sticky-10"/><a class="sticky-link"href="../modules/physics.html">physics</a></td></tr>
  <!--tr><td><div class="sticky-entry "id="sticky-10"/><a class="sticky-link"href="../extras/tutorial.html">tutorial</a></td></tr-->
  </tr>
  </table>
</div>
<style type="text/css">
  .sticky-table{
     float: right;
  }

  a.sticky-link{
     color: inherit;
     font-size: 12px;
  }

  a.sticky-link:hover{
     text-decoration: none;
     color: inherit;
  }


  .sticky-entry{
     width: 12px;
     height: 12px;
     float: right;
     border-left: 1px solid rgb(200,200,200);
     border-top: 1px solid rgb(200,200,200);
     border-right: 1px solid rgb(100,100,100);
     border-bottom: 1px solid rgb(100,100,100);

     border-radius: 4px;
     box-shadow: 2px 2px 5px rgba(0,0,0,0.6);
     border: 1px solid blue;
     background-color: transparent; /* white; */
     color: transparent;
  }
  .sticky-entry:hover{
     width: 40px;
     color: rgb(100,100,100);
     background-color: white;
     padding-left: 2px;
     box-shadow: 5px 5px 10px rgba(0,0,0,0.6);
  }
  .sticky-entry:active{
     box-shadow: 0px 0px 0px transparent;
     border-left: 1px solid rgb(70,70,70);
     border-top: 1px solid rgb(70,70,70);
     border-right: 1px solid white;
     border-bottom: 1px solid white;
  }

  #sticky-1{ border: 1px solid rgb(255,0,255); }
  #sticky-2{ border: 1px solid rgb(255,0,0); }
  #sticky-3{ border: 1px solid rgb(255,128,0); }
  #sticky-4{ border: 1px solid rgb(255,255,0); }
  #sticky-5{ border: 1px solid rgb(168,255,0); }
  #sticky-6{ border: 1px solid rgb(0,200,255); }
  #sticky-7{ border: 1px solid rgb(0,255,0); }
  #sticky-8{ border: 1px solid rgb(0,50,255); }
  #sticky-9{ border: 1px solid rgb(0,0,255); }
  #sticky-10{ border: 1px solid rgb(128,0,255); }

  #sticky{
    line-height: 8px;
    margin-left:auto;
    position:absolute;
    right:0px;
    top:100px;
    padding:2px;
    padding-right:0px;
    padding-left:1px;
    position: fixed;
    background: transparent url(../_static/images/dash.png);
    width: 33px;
    height: 193px;
    top: 99px;
    padding-top: 12px;
  }

</style>

<script type="text/javascript">

$('#sticky-1').bind('click',function(e){ location = '../modules/utils.html';  });
$('#sticky-2').bind('click',function(e){ location = '../modules/math.html';  });
$('#sticky-3').bind('click',function(e){ location = '../modules/core.html';  });
$('#sticky-4').bind('click',function(e){ location = '../modules/filter.html';  });
$('#sticky-5').bind('click',function(e){ location = '../modules/io.html';  });
$('#sticky-6').bind('click',function(e){ location = '../modules/cv.html';  });
$('#sticky-7').bind('click',function(e){ location = '../modules/qt.html';  });
$('#sticky-8').bind('click',function(e){ location = '../modules/geom.html';  });
$('#sticky-9').bind('click',function(e){ location = '../modules/markers.html';  });
$('#sticky-10').bind('click',function(e){ location = '../modules/physics.html.html';  });

/* Script by: www.jtricks.com
 * Version: 20071127
 * Latest version:
 * www.jtricks.com/javascript/navigation/fixed_menu.html
 */
fixedMenuId = 'sticky';

var fixedMenu = {
    hasInner: typeof(window.innerWidth) == 'number',
    hasElement: document.documentElement != null
       && document.documentElement.clientWidth,

    menu: document.getElementById
        ? document.getElementById(fixedMenuId)
        : document.all
          ? document.all[fixedMenuId]
          : document.layers[fixedMenuId]
};

fixedMenu.computeShifts = function(){
    fixedMenu.shiftX = fixedMenu.hasInner
        ? pageXOffset
        : fixedMenu.hasElement
          ? document.documentElement.scrollLeft
          : document.body.scrollLeft;
    if (fixedMenu.targetLeft > 0){
        fixedMenu.shiftX += fixedMenu.targetLeft;
    }else{
        fixedMenu.shiftX +=
            (fixedMenu.hasElement
              ? document.documentElement.clientWidth
              : fixedMenu.hasInner
                ? window.innerWidth - 20
                : document.body.clientWidth)
            - fixedMenu.targetRight
            - fixedMenu.menu.offsetWidth;
    }

    fixedMenu.shiftY = fixedMenu.hasInner
        ? pageYOffset
        : fixedMenu.hasElement
          ? document.documentElement.scrollTop
          : document.body.scrollTop;
    if (fixedMenu.targetTop > 0){
        fixedMenu.shiftY += fixedMenu.targetTop;
    }else{
        fixedMenu.shiftY +=
            (fixedMenu.hasElement
            ? document.documentElement.clientHeight
            : fixedMenu.hasInner
              ? window.innerHeight - 20
              : document.body.clientHeight)
            - fixedMenu.targetBottom
            - fixedMenu.menu.offsetHeight;
    }
};

fixedMenu.moveMenu = function(){
    fixedMenu.computeShifts();

    if (fixedMenu.currentX != fixedMenu.shiftX
        || fixedMenu.currentY != fixedMenu.shiftY){
        fixedMenu.currentX = fixedMenu.shiftX;
        fixedMenu.currentY = fixedMenu.shiftY;

        if (document.layers){
            fixedMenu.menu.left = fixedMenu.currentX;
            fixedMenu.menu.top = fixedMenu.currentY;
        }else{
            fixedMenu.menu.style.left = fixedMenu.currentX + 'px';
            fixedMenu.menu.style.top = fixedMenu.currentY + 'px';
        }
    }

    fixedMenu.menu.style.right = '';
    fixedMenu.menu.style.bottom = '';
};

fixedMenu.floatMenu = function(){
    fixedMenu.moveMenu();
    setTimeout('fixedMenu.floatMenu()', 20);
};

// addEvent designed by Aaron Moore
fixedMenu.addEvent = function(element, listener, handler){
    if(typeof element[listener] != 'function' ||
       typeof element[listener + '_num'] == 'undefined'){
        element[listener + '_num'] = 0;
        if (typeof element[listener] == 'function'){
            element[listener + 0] = element[listener];
            element[listener + '_num']++;
        }
        element[listener] = function(e){
            var r = true;
            e = (e) ? e : window.event;
            for(var i = 0; i < element[listener + '_num']; i++)
                if(element[listener + i](e) === false)
                    r = false;
            return r;
        }
    }

    //if handler is not already stored, assign it
    for(var i = 0; i < element[listener + '_num']; i++)
        if(element[listener + i] == handler)
            return;
    element[listener + element[listener + '_num']] = handler;
    element[listener + '_num']++;
};

fixedMenu.supportsFixed = function(){
    var testDiv = document.createElement("div");
    testDiv.id = "testingPositionFixed";
    testDiv.style.position = "fixed";
    testDiv.style.top = "0px";
    testDiv.style.right = "0px";
    document.body.appendChild(testDiv);
    var offset = 1;
    if (typeof testDiv.offsetTop == "number"
        && testDiv.offsetTop != null
        && testDiv.offsetTop != "undefined")
    {
        offset = parseInt(testDiv.offsetTop);
    }
    if (offset == 0)
    {
        return true;
    }

    return false;
};

fixedMenu.init = function(){
    if (fixedMenu.supportsFixed())
        fixedMenu.menu.style.position = "fixed";
    else
    {
        var ob =
            document.layers
            ? fixedMenu.menu
            : fixedMenu.menu.style;

        fixedMenu.targetLeft = parseInt(ob.left);
        fixedMenu.targetTop = parseInt(ob.top);
        fixedMenu.targetRight = parseInt(ob.right);
        fixedMenu.targetBottom = parseInt(ob.bottom);

        if (document.layers)
        {
            menu.left = 0;
            menu.top = 0;
        }
        fixedMenu.addEvent(window, 'onscroll', fixedMenu.moveMenu);
        fixedMenu.floatMenu();
    }
};

fixedMenu.addEvent(window, 'onload', fixedMenu.init);

jQuery(document).ready(function() {

  console.log('executing java-script-based document upgrade');

  $('.reference.external').after(function() {

    this.href = this.href.replace('doc/icl-manual/doc/icl-api/','doc/icl-api/');

    var href = this.href;
    var text = this.text;

    var package = 'unknown';
    var type = 'other';

    if( this.text.match('^ICL.*\.h$') ){ // we have a header file
       var m = this.text.match('ICL(\[^/\]*)/.*');
       if( m ){
          package = m[1].toLowerCase();
          type = "header";
       }
    }else if(this.text.match('.*\.h$')){
       package  = 'unknown';
       type = "header";
    }


    var packages = [ 'utils', 'math', 'core', 'filter', 'io', 'qt', 'cv', 'geom', 'markers', 'physics' ];
    var groupLUT = [ ['TIME', 'EXCEPT', 'THREAD', 'RANDOM', 'UTILS' , 'PA', 'XML', 'STRUTILS', 'FUNCTION', 'BASIC__TYPES'],
                     ['LINALG'],
                     ['TYPES', 'GENERAL', 'IMAGE'],
                     ['UNARY', 'BINARY', 'AFFINE', 'NBH', 'INPLACE' ],
                     ['DC_G', 'UTILS_G', 'FILEIO_G', 'MOVIE_FILE_G', 'V4L_G', 'GIGE_G'],
                     ['COMMON', 'HANDLES', 'UNCOMMON'],
                     ['G_RD'],
                     [],
                     ['PLUGINS']
                   ];

    if(package == 'unknown'){
      for(var i=0;i<10;++i){
        if( href.match('.*/namespaceicl_1_1'+packages[i]+'\.html') ){
          package = packages[i];
          // could be a function or a namespace
          if(this.text.match('.*'+packages[i]+'$')){
             type = 'namespace';
          }else if(this.text[0] > 'A' && this.text[0] < 'Z'){
             type = 'global type';
          }else{
             type = 'global function';
          }
          break;
        }
        if( href.match('.*icl_1_1'+packages[i]+'.*') ){
          package = packages[i];
          break;
        }
      }
    }
    if(package == 'unknown'){
      var res = href.match('.*group__(\[^.\]*).*')
      if( res ){
         var groupName = res[1];
         for(var i=0;i<9;++i){
            if(groupLUT[i].indexOf(groupName) != -1){
                package = packages[i];
                break;
            }
         }
         var res2 = this.text.match('.*::(\[^:\]*)$');
         var t = "???";
         if(res2){
            t = res2[1];
         }else{
            t = this.text;
         }
         if(t[0] > 'A' && t[0] < 'Z'){
            type = "grouped type";
         }else{
            if(groupName == "TYPES"){
              type = "core type";
            }else if(groupName == "BASIC__TYPES"){
              type = "basic type";
            }else{
              type = "grouped func.";
            }
         }
       }
    }

    if(href.match('.*classicl.*')){
       if(href.match('.*#\[0-9a-f\]*')){
         type = 'class: method';
       }else{
         type = 'class';
       }
    }else if(href.match('.*structicl.*')){
       if(href.match('.*#\[0-9a-f\]*')){
         type = 'struct: method';
       }else{
         type = 'struct';
       }
    }
    if(package == "unknown" && href.match('.*namespaceicl.*')){
      // very special treatment
      return '<div class="tooltip">the <b>icl</b> namespace is used for all '
            +'modules.</div>';

    }else if(package != "unknown"){
      return '<div class="tooltip">'
         + '<a href="../modules/'+package+'.html">'
         + '<img title="manual: '+package+' module" width="110px" src="../_images/'+package+'1.png"></img>'
         + '</a>'
         + '<br/>' + 'Type:   <b>' + type + '</b>'
         + '</div>';
    }else{
      return '<div class="tooltip">'
         + 'Unable to locate package'
         + '<br/>' + 'Type:   <b>' + type + '</b>'
         + '</div>';
    }

    //return '<div class="tooltip">' + 'TEST TEST TEST' + '</div>';
  });

  $('.reference.external').tooltip({
    position: "top center",
    opacity: 0.95,
    effect: 'fade',
    offset: [7,33]
  });

});
</script>
<style type="text/css">

  .tooltip {
    display:none;
    background: transparent url(../_static/images/tooltip.png);
    font-size:13px;
    height:80px;
    width:131px;
    padding:10px;
    color: #555;
    line-height: 20px;
  }
  a.reference.external {
    color: rgb(20,60,100);
    padding: 2px;
    padding-left: 6px;
    padding-right: 5px;
  }
  a.reference.external:hover {
    color: rgb(20,60,100);
    border: 1px solid rgba(0,0,0,0.3);
    border-radius: 5px;
    box-shadow: 2px 2px 6px rgba(0,0,0,0.2);
    padding: 2px;
    padding-left: 5px;
    padding-right: 4px;
    text-decoration: none;
  }

 div.body{
    border-top-left-radius: 15px;
    border-bottom-left-radius: 15px;
    border: 1px solid rgb(110,110,110);
    box-shadow: 0px 0px 50px rgba(0,0,0,0.7);
  }

  div.body h1{
    border-top-left-radius: 15px;
    box-shadow: 0px 2px 0px rgba(0,0,0,0.4);
  }


  div.body h1, div.body h2, div.body h3, div.body h4{
    margin-bottom: -8px;
    background-repeat: no-repeat;
    margin-left: -41px;
    box-shadow: none;
    border: none;
    opacity: 1;
    color: rgb(230,230,230);
    height: 44px;
    padding-top: 4px;
  }

  div.body h1{
    padding-top: 7px;
    background: transparent url(../_static/images/h1.png);
    margin-top: 8px;
    border-radius: 0px;
    height: 57px;
    padding-top: 3px;
  }

  div.body h2{
    padding-top: 7px;
    background: transparent url(../_static/images/h2.png);
    height: 52px;
  }

  div.body h3{
    background: transparent url(../_static/images/h3.png);
  }

  div.body h4{
    padding-top: 5px;
    height: 42px;
    background: transparent url(../_static/images/h4.png);
    color: rgb(60,60,60);
  }

  div.sphinxsidebar{
    font-size: 80%;
  }

  table.docutils td, table.docutils th{
    border: 0px;
  }
  th {
     background-color: #0F67A1;
     color: rgb(220,220,220);
  }

  img[alt="shadow"]{
     box-shadow: 5px 5px 12px rgba(0,0,0,0.3);
  }

  a.headerlink {
     color: rgb(230,230,230);
  }
  a.headerlink:hover{
     color: white;
     background: transparent;
  }

  h4:hover > a.headerlink {
     color: rgb(60,60,60);
  }
  h4 > a.headerlink {
     color: rgb(90,90,90);
  }
  div.related ul{
     background: rgba(60, 60, 60, 0);
     background-image: url(../_static/images/stripes3.png);
     background-position-x: 2px;
  }
  div.documentwrapper, div.footer {
     background-image: url(../_static/images/stripes1.png);
  }

  img.logo{
     background-color: white;
     border-radius: 8px;
     border: 1px solid #A0A0A0;
     box-shadow: 5px 5px 20px rgba(0,0,0,0.4);
     padding: 8px;
  }

  div.sphinxsidebar #searchbox input[type="text"] {
     width: 160px;
  }

</style><div class="section" id="xml-based-configuration-files">
<span id="config-file-tutorial"></span><h1>XML-based Configuration Files<a class="headerlink" href="#xml-based-configuration-files" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference external" href="../icl-api/classicl_1_1utils_1_1ConfigFile.html">ConfigFile</a> class provides an easy to use yet very powerful
building block for complex applications. <a class="reference external" href="../icl-api/classicl_1_1utils_1_1ConfigFile.html">ConfigFile</a> instances
provide an intuitive interface for XML-based configuration files without
the need for any manual XML-parsing. However, <a class="reference external" href="../icl-api/classicl_1_1utils_1_1ConfigFile.html">ConfigFile</a> can be
easily serialized into simple XML files that are still human readable.</p>
<p>The <a class="reference external" href="../icl-api/classicl_1_1utils_1_1ConfigFile.html">ConfigFile</a> class provides <em>“one line of code solutions”</em> for:</p>
<ul class="simple">
<li>serialization into XML-files</li>
<li>deserialization from XML-files</li>
<li>type-safe insertion of entries</li>
<li>type-safe retrieval of entries</li>
<li>static custom type registration mechanism</li>
</ul>
<div class="section" id="the-xml-structure">
<h2>The XML Structure<a class="headerlink" href="#the-xml-structure" title="Permalink to this headline">¶</a></h2>
<p>First of all, let’s take a look at the XML-Structure that is used. The
<a class="reference external" href="../icl-api/classicl_1_1utils_1_1ConfigFile.html">ConfigFile</a> class uses a restricted XML-format using only three
different types of tags:</p>
<ol class="arabic simple">
<li>a mandatory top level “&lt;config&gt;” tag</li>
<li>“section” tags with an “id” attribute: “&lt;section id=’something’&gt;”</li>
<li>“data” tags with an “id” and a “type” attribute:
“&lt;data id=’entry-id’ type=’int’&gt;5&lt;/data&gt;”</li>
</ol>
<p>Here is an example xml-file:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;config&gt;</span>
  <span class="nt">&lt;section</span> <span class="na">id=</span><span class="s">&quot;general&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;data</span> <span class="na">id=</span><span class="s">&quot;a vector&quot;</span> <span class="na">type=</span><span class="s">&quot;Vec&quot;</span><span class="nt">&gt;</span>1 2 3 0<span class="nt">&lt;/data&gt;</span>
    <span class="nt">&lt;section</span> <span class="na">id=</span><span class="s">&quot;params&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;data</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">id=</span><span class="s">&quot;threshold&quot;</span><span class="nt">&gt;</span>7<span class="nt">&lt;/data&gt;</span>
      <span class="nt">&lt;data</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">id=</span><span class="s">&quot;value&quot;</span><span class="nt">&gt;</span>6.450000<span class="nt">&lt;/data&gt;</span>
      <span class="nt">&lt;data</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">id=</span><span class="s">&quot;filename&quot;</span><span class="nt">&gt;</span>./notHallo.txt<span class="nt">&lt;/data&gt;</span>
    <span class="nt">&lt;/section&gt;</span>
  <span class="nt">&lt;/section&gt;</span>
  <span class="nt">&lt;section</span> <span class="na">id=</span><span class="s">&quot;special&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;data</span> <span class="na">type=</span><span class="s">&quot;char&quot;</span> <span class="na">id=</span><span class="s">&quot;hint&quot;</span><span class="nt">&gt;</span>a<span class="nt">&lt;/data&gt;</span>
    <span class="nt">&lt;data</span> <span class="na">type=</span><span class="s">&quot;char&quot;</span> <span class="na">id=</span><span class="s">&quot;no-hint&quot;</span><span class="nt">&gt;</span>b<span class="nt">&lt;/data&gt;</span>
  <span class="nt">&lt;/section&gt;</span>
<span class="nt">&lt;/config&gt;</span>
</pre></div>
</div>
<p>As we can see, the file has a very simple structure. Sections may
contain data nodes and/or other sections. Each data node defines an
entry of the <a class="reference external" href="../icl-api/classicl_1_1utils_1_1ConfigFile.html">ConfigFile</a> where the actual data entry is given by
the text-value of the data nodes.</p>
</div>
<div class="section" id="reading-and-writing-xml-files">
<h2>Reading and Writing XML Files<a class="headerlink" href="#reading-and-writing-xml-files" title="Permalink to this headline">¶</a></h2>
<p>In C++, the file (here called
<strong>config.xml</strong> can be loaded by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ConfigFile</span> <span class="n">cfg</span><span class="p">(</span><span class="s2">&quot;config.xml&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>This will parse the whole config-file and create an efficient STL-map
based lookup for all it’s entries.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Internally, we use the 3rd party library pugi-XML as XML parser,
which is included as a source file and directly linked into the
ICLUtils library</p>
</div>
<p>The <a class="reference external" href="../icl-api/classicl_1_1utils_1_1ConfigFile.html">ConfigFile</a> instance <strong>cfg</strong> can now also intuitively be
written to an xml-file (here named “config2.xml” using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cfg</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;config2.xml&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="adding-entries-to-the-xml-file">
<h2>Adding Entries to the XML File<a class="headerlink" href="#adding-entries-to-the-xml-file" title="Permalink to this headline">¶</a></h2>
<p>Lets start with an empty file and add all the entries of the
example above.</p>
<div class="highlight-c++ notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;ICLUtils/ConfigFile.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;ICLQt/Common.h&gt;</span><span class="cp"></span>

<span class="c1">// for the Vec type</span>
<span class="cp">#include</span> <span class="cpf">&lt;ICLGeom/GeomDefs.h&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
  <span class="n">ConfigFile</span> <span class="n">cfg</span><span class="p">;</span>
  <span class="n">cfg</span><span class="p">[</span><span class="s">&quot;config.general.a vector&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Vec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
  <span class="n">cfg</span><span class="p">[</span><span class="s">&quot;config.general.params.threshold&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
  <span class="n">cfg</span><span class="p">[</span><span class="s">&quot;config.general.params.value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">6.45</span><span class="p">;</span>
  <span class="n">cfg</span><span class="p">[</span><span class="s">&quot;config.general.params.filename&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">str</span><span class="p">(</span><span class="s">&quot;./notHallo.txt&quot;</span><span class="p">);</span>
  <span class="n">cfg</span><span class="p">[</span><span class="s">&quot;config.special.hint&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;a&#39;</span><span class="p">;</span>
  <span class="n">cfg</span><span class="p">[</span><span class="s">&quot;config.special.nohint&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;b&#39;</span><span class="p">;</span>
  <span class="n">SHOW</span><span class="p">(</span><span class="n">cfg</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>As we can see, this is at least as transparent as writing the XML-file
manually. Sections are addressed by the ‘.’-delimited string list where
the last token always defines the actual data-entry’s <em>id</em>. The example
also shows, that sections are automatically added on demand during the
C++-based creation process. Furthermore, we demonstrate the automatic
type inference mechanism, that derives the data-tag’s type entry from
the source type. Types that are not registered cannot be added to
<a class="reference external" href="../icl-api/classicl_1_1utils_1_1ConfigFile.html">ConfigFile</a> instances:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>struct MyType {};
ConfigFile f;
f[&quot;config.x&quot;] = MyType(); // error type is not registered!
</pre></div>
</div>
<div class="section" id="the-prefix">
<h3>The Prefix<a class="headerlink" href="#the-prefix" title="Permalink to this headline">¶</a></h3>
<p>During the data insertion, we might have to use an identical prefix
several times leading to many long lines in your C++-code. This can
be bypassed by setting up the <a class="reference external" href="../icl-api/classicl_1_1utils_1_1ConfigFile.html">ConfigFile</a> instance with a
temporary path prefix.</p>
<div class="highlight-c++ notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;ICLUtils/ConfigFile.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;ICLQt/Common.h&gt;</span><span class="cp"></span>

<span class="c1">// for the Vec type</span>
<span class="cp">#include</span> <span class="cpf">&lt;ICLGeom/GeomDefs.h&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
  <span class="n">ConfigFile</span> <span class="n">cfg</span><span class="p">;</span>
  <span class="n">cfg</span><span class="p">[</span><span class="s">&quot;config.general.a vector&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Vec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
  <span class="n">cfg</span><span class="p">.</span><span class="n">setPrefix</span><span class="p">(</span><span class="s">&quot;config.general.params.&quot;</span><span class="p">);</span>
  <span class="n">cfg</span><span class="p">[</span><span class="s">&quot;threshold&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
  <span class="n">cfg</span><span class="p">[</span><span class="s">&quot;value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">6.45</span><span class="p">;</span>
  <span class="n">cfg</span><span class="p">[</span><span class="s">&quot;filename&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">str</span><span class="p">(</span><span class="s">&quot;./notHallo.txt&quot;</span><span class="p">);</span>
  <span class="n">cfg</span><span class="p">.</span><span class="n">setPrefix</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">);</span>
  <span class="n">cfg</span><span class="p">[</span><span class="s">&quot;config.special.hint&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;a&#39;</span><span class="p">;</span>
  <span class="n">cfg</span><span class="p">[</span><span class="s">&quot;config.special.nohint&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;b&#39;</span><span class="p">;</span>
  <span class="n">SHOW</span><span class="p">(</span><span class="n">cfg</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The prefix is just treated as an <strong>std::string</strong> variable, that
is automatically prepended to the :icl::<cite>ConfigFile</cite>’s index
operator’s argument. Therefore, the prefix must actually end with
a ‘.’-character so that the following relative paths make sense
then.</p>
</div>
</div>
</div>
<div class="section" id="extracting-entries-for-config-files">
<h2>Extracting Entries for Config Files<a class="headerlink" href="#extracting-entries-for-config-files" title="Permalink to this headline">¶</a></h2>
<p>For the extraction of <a class="reference external" href="../icl-api/classicl_1_1utils_1_1ConfigFile.html">ConfigFile</a> entries, a special C++-
technique is used in order to provide type-safe lvalue-based type
inference. Let’s first consider some examples:</p>
<div class="highlight-c++ notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;ICLUtils/ConfigFile.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;ICLQt/Common.h&gt;</span><span class="cp"></span>

<span class="c1">// for the Vec type</span>
<span class="cp">#include</span> <span class="cpf">&lt;ICLGeom/GeomDefs.h&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
  <span class="n">ConfigFile</span> <span class="n">cfg</span><span class="p">(</span><span class="s">&quot;config-file.xml&quot;</span><span class="p">);</span>

  <span class="n">Vec</span> <span class="n">v</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">[</span><span class="s">&quot;config.general.a vector&quot;</span><span class="p">];</span>
  <span class="n">cfg</span><span class="p">.</span><span class="n">setPrefix</span><span class="p">(</span><span class="s">&quot;config.general.params.&quot;</span><span class="p">);</span>
  <span class="kt">int</span> <span class="n">threshold</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">[</span><span class="s">&quot;threshold&quot;</span><span class="p">];</span>
  <span class="kt">double</span> <span class="n">value</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">[</span><span class="s">&quot;value&quot;</span><span class="p">];</span>
  <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">filename</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">[</span><span class="s">&quot;filename&quot;</span><span class="p">];</span>

  <span class="n">SHOW</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
  <span class="n">SHOW</span><span class="p">(</span><span class="n">threshold</span><span class="p">);</span>
  <span class="n">SHOW</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
  <span class="n">SHOW</span><span class="p">(</span><span class="n">filename</span><span class="p">);</span>

<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>The example demonstrates the intuitive mechanism. Please note, that
extracting an entry as a wrong type leads to an exception, even
if the assignment seems trivial:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>float value2 = cfg[&quot;config.general.params.value&quot;]; // error!
</pre></div>
</div>
<p>If a behavior like this is required, one can either first use a
correct assignment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">double</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;config.general.params.value&quot;</span><span class="p">];</span>
<span class="nb">float</span> <span class="n">value2</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">;</span>
</pre></div>
</div>
<p>Or use the <a class="reference external" href="../icl-api/classicl_1_1utils_1_1ConfigFile_1_1Data.html#afe0221470fd9d9145d2e9ab2a15e8e76">ConfigFile::Data::as</a> method, that implements
an explicit yet still type-safe cast into a given destination
type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">float</span> <span class="n">value2</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;config.general.params.value&quot;</span><span class="p">]</span><span class="o">.</span><span class="k">as</span><span class="o">&lt;</span><span class="n">double</span><span class="o">&gt;</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="static-type-registration">
<h2>Static Type Registration<a class="headerlink" href="#static-type-registration" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="../icl-api/classicl_1_1utils_1_1ConfigFile.html">ConfigFile</a> class can also be set up to accept custom
types. For this, C++’s ostream- and istream-operators must fist
be overloaded for the desired type. The new type can then be
registered using the <a class="reference external" href="../icl-api/classicl_1_1utils_1_1ConfigFile.html#af3c7f201095c3ac64522e5e6eeb627a9">ConfigFile::register_type</a> template,
which gets a template-based type and a string-based type-ID. Here is
an example:</p>
<div class="highlight-c++ notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;ICLUtils/ConfigFile.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;ICLQt/Common.h&gt;</span><span class="cp"></span>

<span class="c1">// a custom data type</span>
<span class="k">struct</span> <span class="n">MyPoint</span><span class="p">{</span>
  <span class="n">MyPoint</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">:</span><span class="n">x</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">y</span><span class="p">(</span><span class="n">y</span><span class="p">){}</span>
  <span class="kt">int</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// overloaded ostream-operator</span>
<span class="n">std</span><span class="o">::</span><span class="n">ostream</span> <span class="o">&amp;</span><span class="k">operator</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">ostream</span> <span class="o">&amp;</span><span class="n">s</span><span class="p">,</span> <span class="k">const</span> <span class="n">MyPoint</span> <span class="o">&amp;</span><span class="n">p</span><span class="p">){</span>
  <span class="k">return</span> <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;(&#39;</span> <span class="o">&lt;&lt;</span> <span class="n">p</span><span class="p">.</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;,&#39;</span> <span class="o">&lt;&lt;</span> <span class="n">p</span><span class="p">.</span><span class="n">y</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;)&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// overloaded istream-operator (note, this sould actually</span>
<span class="c1">// be more robust agains parsing errors)</span>
<span class="n">std</span><span class="o">::</span><span class="n">istream</span> <span class="o">&amp;</span><span class="k">operator</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">istream</span> <span class="o">&amp;</span><span class="n">s</span><span class="p">,</span> <span class="n">MyPoint</span> <span class="o">&amp;</span><span class="n">p</span><span class="p">){</span>
  <span class="kt">char</span> <span class="n">dummy</span><span class="p">;</span>
  <span class="k">return</span> <span class="n">s</span> <span class="o">&gt;&gt;</span> <span class="n">dummy</span> <span class="o">&gt;&gt;</span> <span class="n">p</span><span class="p">.</span><span class="n">x</span> <span class="o">&gt;&gt;</span> <span class="n">dummy</span> <span class="o">&gt;&gt;</span> <span class="n">p</span><span class="p">.</span><span class="n">y</span> <span class="o">&gt;&gt;</span> <span class="n">dummy</span><span class="p">;</span>
<span class="p">}</span>


<span class="kt">int</span> <span class="n">main</span><span class="p">(){</span>
  <span class="n">ConfigFile</span> <span class="n">cfg</span><span class="p">;</span>

  <span class="c1">// register type</span>
  <span class="n">ConfigFile</span><span class="o">::</span><span class="n">register_type</span><span class="o">&lt;</span><span class="n">MyPoint</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;MyPoint&quot;</span><span class="p">);</span>

  <span class="c1">// add type instance</span>
  <span class="n">cfg</span><span class="p">[</span><span class="s">&quot;config.p&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MyPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>

  <span class="c1">// extract type instance</span>
  <span class="n">MyPoint</span> <span class="n">p</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">[</span><span class="s">&quot;config.p&quot;</span><span class="p">];</span>

  <span class="n">SHOW</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>

  <span class="n">SHOW</span><span class="p">(</span><span class="n">cfg</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="use-the-configfile-for-de-serialization">
<h2>Use the <a class="reference external" href="../icl-api/classicl_1_1utils_1_1ConfigFile.html">ConfigFile</a> for (De)serialization<a class="headerlink" href="#use-the-configfile-for-de-serialization" title="Permalink to this headline">¶</a></h2>
<p>For complex types it is usually quite difficult to find a nice way to
implement C++-‘s <strong>istream</strong>- and <strong>ostream</strong>-operators. In particular
the implementation if the <strong>istream</strong>-operator is usually very
difficult because it should usually also detect parsing errors. Using the
<a class="reference external" href="../icl-api/classicl_1_1utils_1_1ConfigFile.html">ConfigFile</a> class for this has two advantages: first, it solves
all serialization and deserialization issues, and second, it also leads
to a human readable and well defined XML-based serialization string.</p>
<div class="highlight-c++ notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">THIS</span> <span class="n">NEEDS</span>  <span class="n">TO</span> <span class="n">BE</span> <span class="n">WRITTEN</span>
</pre></div>
</td></tr></table></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">XML-based Configuration Files</a><ul>
<li><a class="reference internal" href="#the-xml-structure">The XML Structure</a></li>
<li><a class="reference internal" href="#reading-and-writing-xml-files">Reading and Writing XML Files</a></li>
<li><a class="reference internal" href="#adding-entries-to-the-xml-file">Adding Entries to the XML File</a><ul>
<li><a class="reference internal" href="#the-prefix">The Prefix</a></li>
</ul>
</li>
<li><a class="reference internal" href="#extracting-entries-for-config-files">Extracting Entries for Config Files</a></li>
<li><a class="reference internal" href="#static-type-registration">Static Type Registration</a></li>
<li><a class="reference internal" href="#use-the-configfile-for-de-serialization">Use the ConfigFile for (De)serialization</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="program-arguments.html"
                        title="previous chapter">Evaluating Program Arguments</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="interactive-gui-apps.html"
                        title="next chapter">Interactive GUI Applications</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="interactive-gui-apps.html" title="Interactive GUI Applications"
             >next</a> |</li>
        <li class="right" >
          <a href="program-arguments.html" title="Evaluating Program Arguments"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">ICL Manual</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../extras/tutorial.html" >Tutorials</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2006-2019, Christof Elbrechter, Michael Götting, Robert Haschke, Alexander Neumann.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>